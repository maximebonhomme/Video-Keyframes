var VideoKeyframe=function($video){this.video=$video[0],this.duration=0,this.currentTime=0,this.isPlaying=!1,this.labels=[],this.interval=0,this.speed=50,this.calling=!1,this.settings={name:null,pause:!1},$video.on("canplay",this.init.bind(this)),$video.on("playing",this.playing.bind(this)),$video.on("pause",this.paused.bind(this)),$video.on("ended",this.paused.bind(this))};VideoKeyframe.prototype={init:function(){this.duration=this.video.duration,this.interval=setInterval(this.update.bind(this),this.speed)},addLabel:function(time,callback,options){var opts=$.extend({},this.settings,options),label={time:opts.fromEnd?this.duration-time:time,callback:callback,options:opts};return time>this.duration?void console.error("time cannot be greater than duration"):void this.labels.push(label)},getLabel:function(id){var type=typeof id;if("number"===type)return void 0===this.labels[id]?void console.error("no label found for id "+id):this.labels[id];if("string"===type){var label=$.grep(this.labels,function(e){return e.options.name==id});return label.length?label[0]:void console.error("no label found for id "+id)}return void console.error("int or string only")},playFrom:function(id){var type=typeof id;if("number"===type){if(void 0===this.labels[id])return void console.error("no label found for id "+id);console.error(this.labels[id]),this.currentTime=this.labels[id].time}else{if("string"!==type)return void console.error("int or string only");var label=$.grep(this.labels,function(e){return e.options.name==id});if(void 0===label)return void console.error("no label found for id "+id);this.currentTime=label[0].time}this.video.play()},seekLabels:function(){var _this=this;$.each(this.labels,function(){var time=parseFloat(this.time.toFixed(1)),callback=this.callback,options=this.options;time!==_this.currentTime||_this.calling||(_this.calling=!0,callback(),options.pause?_this.video.pause():setTimeout(function(){_this.calling=!1},50))})},playing:function(){var _this=this;this.isPlaying=!0,this.interval=setInterval(this.update.bind(this),this.speed),setTimeout(function(){_this.calling=!1},50)},paused:function(){this.isPlaying=!1},update:function(){this.isPlaying?(this.currentTime=parseFloat(this.video.currentTime.toFixed(1)),this.seekLabels()):(clearInterval(this.interval),this.interval=0)}};